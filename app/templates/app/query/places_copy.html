{% load app_tags %}
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>{{ query.name.capitalize }}</title>
    <style>
        body {
            font-family: 'National', 'Helvetica Neue', 'Helvetica', Arial, sans-serif;
            line-height: 1.42857143;
        }

        .block_title {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .places {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            margin: auto;
            width: 80%;
        }

        .place {
            min-width: 360px;
            max-width: 1080px;
            width: 100%;
            display: flex;
            justify-content: center;
            flex-direction: row;
        }

        .place_img {
            width: 250px !important;
            height: 250px !important;
            border-radius: 6px;
            box-shadow: 0 0.5em 1em -0.125em rgb(10 10 10 / 10%), 0 0 0 1px rgb(10 10 10 / 2%);
        }

        .place_content {
            flex-grow: 1;
            padding: 0px 10px;
            display: flex;
            align-items: start;
            flex-direction: column;

        }

        .place_title {
            align-self: center;
            margin-top: 5px;
        }

        .box {
            background-color: #fff;
            border-radius: 6px;
            box-shadow: 0 0.5em 1em -0.125em rgb(10 10 10 / 10%), 0 0 0 1px rgb(10 10 10 / 2%);
            color: #4a4a4a;
            padding: 1.25rem;
            margin: 10px;
            width: 100%;
        }

        .review {
            border: 1px dashed grey;
            padding: 5px;
            margin: 15px auto;
            border-radius: 5px;
        }

        .letters {
            display: flex;
            justify-content: start;
            flex-wrap: wrap;
        }

        .letter {
            width: 25%;
        }

        .letter_place {
            color: #62657a;
        }
    </style>
    <style>
        @media (max-width: 630px) {
            .place {
                flex-direction: column !important;
            }

            .place_img {
                margin-bottom: 10px;
            }

            .place_img {
                width: 100% !important;
            }
        }
    </style>
</head>
<body>
<div class="header">
    <h2 class="block_title">{{ query.name.capitalize }}</h2>
</div>
<div class="places">
    {% for place in places %}
        <div class="box">
            <div class="place">
                <img src="{{ place.get_img }}" alt="" class="place_img">
                <div class="place_content">
                    <h5 class="place_title"> {{ place.name }} </h5>
                    <div>
                        <span>Rating:</span>
                        <span>{{ place.rating }}</span>
                    </div>
                    <div>
                        <span>Address:</span>
                        <span>{{ place.address }}</span>
                    </div>
                    <div>
                        <span>Phone:</span>
                        <span>{{ place.phone_number }}</span>
                    </div>
                    <div>
                        <span>Description:</span>
                        <span>{{ place.get_description }}</span>
                    </div>
                </div>
            </div>

            {% with place.get_more_text as review %}
                {% if review %}
                    <div class="review">
                        <div class="">
                            <span>{{ review.get_user_name }}</span>
                            <span>{{ review.get_rating }}</span>
                        </div>
                        <hr>
                        {{ review.text }}
                    </div>
                {% endif %}
            {% endwith %}
        </div>
    {% endfor %}
</div>
<h4 class="block_title">Весь список</h4>
<div class="letters">
    {% for letter in letters %}
        <div class="letter">
            <hr>
            <span style="color: cornflowerblue">{{ letter }}</span>
            {% for place in places_letter|getValue:letter|getValue:'places' %}
                <p class="letter_place">{{ place.name }}</p>
            {% endfor %}
        </div>
    {% endfor %}
</div>

</body>
</html>