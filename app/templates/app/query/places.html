{% extends 'app/base.html' %}
{% load app_tags %}

{% block title %}
    {{ query.name }}
{% endblock %}


{% block style %}
    <style>
    </style>
{% endblock %}
{% block content %}
    <h4 class="block_title"> {{ query.name }} </h4>

    <hr>
    <div class="columns is-centered">
        <div class="column is-9">
            <h4 style="text-align: center">Описание</h4>
            {% if request.user|hasGroup:'Администратор' %}
                <a href="{% url 'app:query_edit' query.slug %}" class="button is-success is-light is-outlined centered"
                   style="width: fit-content">Редактировать</a>
            {% endif %}
            <div>
                {{ query.content|isValue:'<span style="color: grey; margin: 10px auto; display: block; width: fit-content;">Описание не найдено</span>'|safe }}
            </div>
            <br>
            <div style="display:flex; justify-content: center">
                {% for tag in query.tags.all %}
                    <span class="tag is-medium is-info" style="margin: 3px;">{{ tag.name }}</span>
                {% endfor %}
            </div>
        </div>
    </div>
    {% if request.user.is_authenticated %}
        <a href="{% url 'app:query_rating_edit' query.slug %}" style="text-align: center;">Редактировать рейтинг</a>
    {% endif %}
    <div class="columns is-centered is-multiline">
        {% for place in top_places %}
            {% include 'app/include/place/preview_card.html' with place=place %}
        {% endfor %}
    </div>
    <hr>

    <h4 class="block_title">Весь список</h4>
    <div class="columns is-multiline">
        {% for letter in letters %}
            <div class="column is-3">
                <hr>
                <span style="color: cornflowerblue">{{ letter }}</span>
                {% for place in places_letter|getValue:letter|getValue:'places' %}
                    <p><a href="{{ place.get_absolute_url }}" class="hover_link">{{ place.name }}</a></p>
                {% endfor %}
            </div>
        {% endfor %}
    </div>
    <hr>
    <div style="color: grey">
        <p>Всего {{ places.count }} объектов</p>
    </div>
{% endblock %}